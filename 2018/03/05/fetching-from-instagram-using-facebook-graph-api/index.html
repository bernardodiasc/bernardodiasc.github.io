<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"><meta content="#000000" name="theme-color"><link href="/manifest.json" rel="manifest"><link href="/favicon.ico" rel="shortcut icon"><title>Fetching from Instagram using Facebook Graph API - Bernardo Dias da Cruz</title><link href="/styles/main.css" rel="stylesheet"><link href="/static/css/main.99e9502a.css" rel="stylesheet"><link href="https://www.googletagmanager.com" rel="preconnect"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="/" rel="canonical" data-react-helmet="true"><meta content="Instagram API is being deprecated and from now will be using Facebook Graph API" data-react-helmet="true" name="description"><meta content="Instagram API is being deprecated and from now will be using Facebook Graph API" data-react-helmet="true" name="twitter:card"><meta content="@bernardodiasc" data-react-helmet="true" name="twitter:site"><meta content="Fetching from Instagram using Facebook Graph API - Bernardo Dias da Cruz" data-react-helmet="true" name="twitter:title"><meta content="Instagram API is being deprecated and from now will be using Facebook Graph API" data-react-helmet="true" name="twitter:description"><meta content="@bernardodiasc" data-react-helmet="true" name="twitter:creator"><meta content="Fetching from Instagram using Facebook Graph API - Bernardo Dias da Cruz" data-react-helmet="true" property="og:title"><meta content="article" data-react-helmet="true" property="og:type"><meta content="https://bernardodiasc.github.io/" data-react-helmet="true" property="og:url"><meta content="Instagram API is being deprecated and from now will be using Facebook Graph API" data-react-helmet="true" property="og:description"><meta content="Bernardo Dias da Cruz" data-react-helmet="true" property="og:site_name"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://bernardodiasc.disqus.com" rel="preconnect"><link href="https://c.disquscdn.com/next/embed/styles/lounge.2d848eddee1b8c12749b72a04b2b33dc.css" rel="preload" as="style"><link href="https://c.disquscdn.com/next/embed/common.bundle.774abcf1e2c32f6ee53499b090f48ff0.js" rel="preload" as="script"><link href="https://c.disquscdn.com/next/embed/lounge.bundle.8241ae5fc761eb94635acdc63f5fd29f.js" rel="preload" as="script"><link href="https://disqus.com/next/config.js" rel="preload" as="script"><link href="https://disqus.com" rel="preconnect"><link href="https://c.disquscdn.com" rel="preconnect"><script src="https://c.disquscdn.com/next/embed/alfalfa.4a5fcca1fe50a757044dfd331b660625.js" async charset="UTF-8"></script><link href="https://ssl.google-analytics.com" rel="preconnect"><link href="https://connect.facebook.net" rel="preconnect"><link href="http://cdn.viglink.com" rel="preconnect"><link href="https://apis.google.com" rel="preconnect"><link href="https://staticxx.facebook.com" rel="preconnect"><link href="https://www.facebook.com" rel="preconnect"><link href="https://www.facebook.com" rel="preconnect"><link href="https://accounts.google.com" rel="preconnect"><link href="https://ssl.gstatic.com" rel="preconnect"><link href="https://links.services.disqus.com" rel="preconnect"><link href="https://glitter.services.disqus.com" rel="preconnect"><link href="https://referrer.disqus.com" rel="preconnect"><link href="https://pippio.com" rel="preconnect"><link href="https://tags.bluekai.com" rel="preconnect"><link href="https://pixel.sojern.com" rel="preconnect"><link href="https://loadus.exelator.com" rel="preconnect"><link href="https://io.narrative.io" rel="preconnect"><link href="https://cm.g.doubleclick.net" rel="preconnect"><link href="https://live.rezync.com" rel="preconnect"><link href="https://stags.bluekai.com" rel="preconnect"><link href="https://idsync.rlcdn.com" rel="preconnect"><link href="https://id.rlcdn.com" rel="preconnect"><link href="https://sp.adbrn.com" rel="preconnect"><link href="https://dc.arrivalist.com" rel="preconnect"><link href="https://ei.rlcdn.com" rel="preconnect"><link href="https://in.v12group.com" rel="preconnect"><link href="https://cipix.acxiom.com" rel="preconnect"><link href="/static/js/main.d313a0ab.js" rel="preload" as="script"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><main class="Layout"><div class="Layout__headerbar"><header class="Layout-HeaderBar"><h1 class="Layout-HeaderBar__title"><a href="/" class="AppLink undefined">Random Thoughts</a></h1><div class="Layout-HeaderBar__about"><img alt="Bernardo Dias da Cruz" class="Layout-HeaderBar__about-picture" src="/images/me.jpg"><p>I'm <strong>Bernardo Dias da Cruz</strong>,<br>a web developer and thinker.</p><p><a href="/about-me" class="AppLink undefined">More about me.</a></p><p class="Layout-HeaderBar__social"><span>Follow me on </span><a href="https://twitter.com/bernardodiasc" rel="noopener noreferrer" target="_blank">Twitter</a><span> and </span><a href="https://github.com/bernardodiasc" rel="noopener noreferrer" target="_blank">GitHub</a>.</p></div><div style="display:none"><h2>Filter posts</h2><a href="/archive" class="AppLink undefined">Archive</a><nav><h3>Categories</h3><ul><li><a href="/category/third-party" class="AppLink undefined">third-party</a></li><li><a href="/category/This Blog" class="AppLink undefined">This Blog</a></li><li><a href="/category/Strategy" class="AppLink undefined">Strategy</a></li></ul></nav><nav><h3>Tags</h3><ul><li><a href="/search/?instagram" class="AppLink undefined">instagram</a></li><li><a href="/search/?facebook" class="AppLink undefined">facebook</a></li><li><a href="/search/?graph api" class="AppLink undefined">graph api</a></li><li><a href="/search/?fetch" class="AppLink undefined">fetch</a></li><li><a href="/search/?css grid" class="AppLink undefined">css grid</a></li><li><a href="/search/?responsiveness" class="AppLink undefined">responsiveness</a></li><li><a href="/search/?design" class="AppLink undefined">design</a></li><li><a href="/search/?typography" class="AppLink undefined">typography</a></li><li><a href="/search/?CSS" class="AppLink undefined">CSS</a></li><li><a href="/search/?life" class="AppLink undefined">life</a></li><li><a href="/search/?business" class="AppLink undefined">business</a></li><li><a href="/search/?development" class="AppLink undefined">development</a></li><li><a href="/search/?disqus" class="AppLink undefined">disqus</a></li><li><a href="/search/?react" class="AppLink undefined">react</a></li><li><a href="/search/?node.js" class="AppLink undefined">node.js</a></li><li><a href="/search/?yarn" class="AppLink undefined">yarn</a></li><li><a href="/search/?boilerplate" class="AppLink undefined">boilerplate</a></li><li><a href="/search/?generators" class="AppLink undefined">generators</a></li><li><a href="/search/?css" class="AppLink undefined">css</a></li><li><a href="/search/?markdown" class="AppLink undefined">markdown</a></li><li><a href="/search/?static files" class="AppLink undefined">static files</a></li><li><a href="/search/?redux" class="AppLink undefined">redux</a></li><li><a href="/search/?github pages" class="AppLink undefined">github pages</a></li><li><a href="/search/?webpack" class="AppLink undefined">webpack</a></li><li><a href="/search/?filestojson" class="AppLink undefined">filestojson</a></li><li><a href="/search/?frontmatter" class="AppLink undefined">frontmatter</a></li></ul></nav></div></header></div><article class="Layout__content"><div class="PostDetails"><h1 class="PostDetails__title">Fetching from Instagram using Facebook Graph API</h1><p class="PostDetails__meta">Sunday March 4th, 2018</p><div class="TextBlock"><p>Past week I had a task to fetch media from Instagram and build a mosaic wall with it.</p><figure><img alt="Instagram media mosaic at https://x-team.com/join/" width="100%" src="/content/posts/2018-03-05-fetching-from-instagram-using-facebook-graph-api/instagram-media-mosaic.png"><figcaption>This module was included at <a href="https://x-team.com/join/">https://x-team.com/join/</a></figcaption></figure><p>I thought it was going to be trivial, Instagram API v1 is really simple. All we have to do is to create a Client ID and get an Access Token, then fetch a JSONP from the API Url <code><a href="https://api.instagram.com/v1/" class="vglnk" rel="nofollow"><span>https</span><span>://</span><span>api</span><span>.</span><span>instagram</span><span>.</span><span>com</span><span>/</span><span>v1</span><span>/</span></a></code>, boom, done!</p><p>Or even simpler, use some library like <a href="http://instafeedjs.com/">http://instafeedjs.com/</a>... Take a look at this demo on CodePen <a href="https://codepen.io/gabriellewee/pen/qxprPw">https://codepen.io/gabriellewee/pen/qxprPw</a>, how simple it is! Client-side fetching without any trouble.</p><p>Well, the winds changed direction, Instagram now uses Facebook Graph API, which is quite powerful, but it's usage have many differences. Check out the news at Facebook Developer's blog: <a href="https://developers.facebook.com/blog/post/2018/01/30/instagram-graph-api-updates/">Instagram Graph API Launches and Instagram API Platform Deprecation</a>.</p><p>So, this is how to get started on this new Instagram API: <a href="https://developers.facebook.com/docs/instagram-api/getting-started/">https://developers.facebook.com/docs/instagram-api/getting-started/</a>. Not much difficult if you follow all the steps. At the end you'll have a Facebook user access token with grants to fetch Instagram media. Cool, right? Well, some pitfalls found in the way, let me tell you.</p><p>To put simple, the Instagram API works this way:</p><ol><li>You need to have a <strong>Facebook Page</strong> and connect that page to the <strong>Instagram Business Account</strong>;</li><li>Then you need to register a new <strong>Facebook App</strong> with a developer account (see <a href="https://developers.facebook.com/docs/apps/register">https://developers.facebook.com/docs/apps/register</a>);</li><li>Then you need get an access token for your user and figure out your new <strong>App ID</strong> using their tool <a href="https://developers.facebook.com/tools/explorer/">https://developers.facebook.com/tools/explorer/</a>;</li></ol><p>Now, the pitfalls:</p><ul><li>If you plan to make a feching script on client-side, forget about it, because you'll expose you access token, and that's not good idea, you might better to have a backend to fetch the API and safe ways to store your access token;</li><li>If you have an user accound that manages many pages, it's better to not use that too, because the access token generated gives grant to all your managed pages;</li><li>If you are not building a real app, and simply wanting to display a mosaic wall with Instagram media in your site, your user's access token might not work well because it expires really fast;</li></ul><p>Instead explain step-by-step, let me share a really useful answer on StackOverflow that solved all my problems: <a href="https://stackoverflow.com/questions/17197970/facebook-permanent-page-access-token/28418469#28418469">facebook: permanent Page Access Token?</a>. With that I could generate a long-lived (never expiring) access token for a <strong>Facebook Page</strong>!</p><p>The docs for a Node.js usage are quite good: <a href="https://developers.facebook.com/docs/javascript">https://developers.facebook.com/docs/javascript</a></p><p>You will basically need to firstly fetch:</p><pre><code><a href="https://graph.facebook.com/v2.12/[PAGE_ID]/media?access_token=[PAGE_ACCESS_TOKEN" class="vglnk" rel="nofollow"><span>https</span><span>://</span><span>graph</span><span>.</span><span>facebook</span><span>.</span><span>com</span><span>/</span><span>v2</span><span>.</span><span>12</span><span>/[</span><span>PAGE</span><span>_</span><span>ID</span><span>]/</span><span>media</span><span>?</span><span>access</span><span>_</span><span>token</span><span>=[</span><span>PAGE</span><span>_</span><span>ACCESS</span><span>_</span><span>TOKEN</span></a>]
</code></pre><p>This will return a paginated list with media's IDs. Then you need to loop that list and for each item fetching:</p><pre><code><a href="https://graph.facebook.com/v2.12/[MEDIA_ID]?access_token=[PAGE_ACCESS_TOKEN]&fields=media_type,media_url,thumbnail_url,permalink,caption" class="vglnk" rel="nofollow"><span>https</span><span>://</span><span>graph</span><span>.</span><span>facebook</span><span>.</span><span>com</span><span>/</span><span>v2</span><span>.</span><span>12</span><span>/[</span><span>MEDIA</span><span>_</span><span>ID</span><span>]?</span><span>access</span><span>_</span><span>token</span><span>=[</span><span>PAGE</span><span>_</span><span>ACCESS</span><span>_</span><span>TOKEN</span><span>]&</span><span>fields</span><span>=</span><span>media</span><span>_</span><span>type</span><span>,</span><span>media</span><span>_</span><span>url</span><span>,</span><span>thumbnail</span><span>_</span><span>url</span><span>,</span><span>permalink</span><span>,</span><span>caption</span></a>
</code></pre><p>The reference for Instagram media fields available can be found at <a href="https://developers.facebook.com/docs/instagram-api/reference/media">https://developers.facebook.com/docs/instagram-api/reference/media</a></p></div></div><div class="Disqus"><div id="disqus_thread"><iframe id="dsq-app2636" name="dsq-app2636" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&f=bernardodiasc&t_i=2018-03-05-fetching-from-instagram-using-facebook-graph-api&t_u=http%3A%2F%2Flocalhost%3A45678%2F2018%2F03%2F05%2Ffetching-from-instagram-using-facebook-graph-api&t_e=Fetching%20from%20Instagram%20using%20Facebook%20Graph%20API&t_d=Fetching%20from%20Instagram%20using%20Facebook%20Graph%20API&t_t=Fetching%20from%20Instagram%20using%20Facebook%20Graph%20API&s_o=default#version=764be64b45588e3d4124c2234e67fa3c" style="width:1px!important;min-width:100%!important;border:none!important;overflow:hidden!important;height:467px!important" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width:403px!important;border:none!important;overflow:hidden!important;top:0!important;min-width:403px!important;max-width:403px!important;position:fixed!important;z-index:2147483646!important;height:18px!important;min-height:18px!important;max-height:18px!important;display:none!important"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width:403px!important;border:none!important;overflow:hidden!important;bottom:0!important;min-width:403px!important;max-width:403px!important;position:fixed!important;z-index:2147483646!important;height:18px!important;min-height:18px!important;max-height:18px!important;display:none!important"></iframe></div></div></article></main></div><script src="https://www.googletagmanager.com/gtag/js?id=UA-10219275-4" async></script><script>if("localhost"!==window.location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-10219275-4")}</script><script src="/static/js/main.d313a0ab.js" type="text/javascript"></script><script src="https://bernardodiasc.disqus.com/embed.js" async id="dsq-embed-scr"></script><iframe style="display:none"></iframe></body></html>