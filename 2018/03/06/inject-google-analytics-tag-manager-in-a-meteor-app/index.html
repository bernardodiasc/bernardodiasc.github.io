<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"><meta content="#000000" name="theme-color"><link href="/manifest.json" rel="manifest"><link href="/favicon.ico" rel="shortcut icon"><title>Inject Google Analytics tag manager in a Meteor app - Bernardo Dias da Cruz</title><link href="/styles/main.css" rel="stylesheet"><link href="/static/css/main.183ad9be.css" rel="stylesheet"><link href="https://www.googletagmanager.com" rel="preconnect"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="/" rel="canonical" data-react-helmet="true"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app." data-react-helmet="true" name="description"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app." data-react-helmet="true" name="twitter:card"><meta content="@bernardodiasc" data-react-helmet="true" name="twitter:site"><meta content="Inject Google Analytics tag manager in a Meteor app - Bernardo Dias da Cruz" data-react-helmet="true" name="twitter:title"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app." data-react-helmet="true" name="twitter:description"><meta content="@bernardodiasc" data-react-helmet="true" name="twitter:creator"><meta content="/images/thumbnail.png" data-react-helmet="true" name="twitter:image"><meta content="Inject Google Analytics tag manager in a Meteor app - Bernardo Dias da Cruz" data-react-helmet="true" property="og:title"><meta content="article" data-react-helmet="true" property="og:type"><meta content="https://bernardodiasc.github.io/" data-react-helmet="true" property="og:url"><meta content="/images/thumbnail.png" data-react-helmet="true" property="og:image"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app." data-react-helmet="true" property="og:description"><meta content="Bernardo Dias da Cruz" data-react-helmet="true" property="og:site_name"><link href="https://c.disquscdn.com/next/embed/styles/lounge.afe8bc0f134a77a505cf2ee26c56a3a9.css" rel="preload" as="style"><link href="https://c.disquscdn.com/next/embed/common.bundle.774abcf1e2c32f6ee53499b090f48ff0.js" rel="preload" as="script"><link href="https://c.disquscdn.com/next/embed/lounge.bundle.8241ae5fc761eb94635acdc63f5fd29f.js" rel="preload" as="script"><link href="https://disqus.com/next/config.js" rel="preload" as="script"><link href="https://bernardodiasc.disqus.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://c.disquscdn.com" rel="preconnect"><link href="https://disqus.com" rel="preconnect"><link href="https://c.disquscdn.com" rel="preconnect"><script src="https://c.disquscdn.com/next/embed/alfalfa.4a5fcca1fe50a757044dfd331b660625.js" async charset="UTF-8"></script><link href="https://ssl.google-analytics.com" rel="preconnect"><link href="https://connect.facebook.net" rel="preconnect"><link href="http://cdn.viglink.com" rel="preconnect"><link href="http://cdn.viglink.com" rel="preconnect"><link href="https://apis.google.com" rel="preconnect"><link href="https://staticxx.facebook.com" rel="preconnect"><link href="https://www.facebook.com" rel="preconnect"><link href="https://www.facebook.com" rel="preconnect"><link href="https://accounts.google.com" rel="preconnect"><link href="https://links.services.disqus.com" rel="preconnect"><link href="http://links.services.disqus.com" rel="preconnect"><link href="https://ssl.gstatic.com" rel="preconnect"><link href="https://referrer.disqus.com" rel="preconnect"><link href="https://glitter.services.disqus.com" rel="preconnect"><link href="https://bcp.crwdcntrl.net" rel="preconnect"><link href="https://pippio.com" rel="preconnect"><link href="https://tags.bluekai.com" rel="preconnect"><link href="https://live.rezync.com" rel="preconnect"><link href="https://io.narrative.io" rel="preconnect"><link href="https://loadus.exelator.com" rel="preconnect"><link href="https://id.rlcdn.com" rel="preconnect"><link href="https://ei.rlcdn.com" rel="preconnect"><link href="https://stags.bluekai.com" rel="preconnect"><link href="https://cipix.acxiom.com" rel="preconnect"><link href="https://vanillavalue.com" rel="preconnect"><link href="/static/js/main.9a1f0496.js" rel="preload" as="script"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><main class="Layout"><header class="Layout__header"><h1 class="Layout__header-title"><a aria-current="false" class="AppLink" href="/">Random Thoughts</a></h1><ul class="Layout-Tabs"><li class="Layout-Tabs__tab"><a aria-current="false" class="AppLink Layout-Tabs__link" href="/" title="Latest posts"><svg class="Icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3l-10-9-10 9h3v8z"></path></svg></a></li><li class="Layout-Tabs__tab"><a aria-current="false" class="AppLink Layout-Tabs__link" href="/search" title="Search for content"><svg class="Icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 10.9c-.61 0-1.1.49-1.1 1.1s.49 1.1 1.1 1.1c.61 0 1.1-.49 1.1-1.1s-.49-1.1-1.1-1.1zm0-8.9c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm2.19 12.19l-8.19 3.81 3.81-8.19 8.19-3.81-3.81 8.19z"></path></svg></a></li><li class="Layout-Tabs__tab"><a aria-current="false" class="AppLink Layout-Tabs__link" href="/archive" title="Content archive"><svg class="Icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z"></path></svg></a></li><li class="Layout-Tabs__tab"><a aria-current="false" class="AppLink Layout-Tabs__link" href="/about-me" title="About me"><svg class="Icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M21,13A9,9 0 0,1 12,22A9,9 0 0,1 3,13L3.03,4.43C5.68,2.88 8.76,2 12.05,2C15.3,2 18.36,2.87 21,4.38V13M13,19.93C16.39,19.44 19,16.5 19,13V5.59C16.9,4.57 14.54,4 12.05,4C9.5,4 7.08,4.6 4.94,5.66L5,13C5,16.5 7.63,19.44 11,19.93V18H13V19.93M11,16H8L6,13L9,14H10L11,13H13L14,14H15L18,13L16,16H13L12,15L11,16M6,9.03C6.64,8.4 7.5,8.05 8.5,8.05C9.45,8.05 10.34,8.4 11,9.03C10.34,9.65 9.45,10 8.5,10C7.5,10 6.64,9.65 6,9.03M13,9.03C13.64,8.4 14.5,8.05 15.5,8.05C16.45,8.05 17.34,8.4 18,9.03C17.34,9.65 16.45,10 15.5,10C14.5,10 13.64,9.65 13,9.03Z"></path></svg></a></li></ul></header><article class="Layout__content"><div class="Layout__content-inner"><div class="PostDetails"><div class="PostHeader PostHeader--details"><p class="PostHeader__category"><a aria-current="false" class="AppLink PostHeader__category-link" href="/category/third-party"><span class="PostHeader__icon"><svg class="Icon" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M20.5 11h-1.5v-4c0-1.1-.9-2-2-2h-4v-1.5c0-1.38-1.12-2.5-2.5-2.5s-2.5 1.12-2.5 2.5v1.5h-4c-1.1 0-1.99.9-1.99 2v3.8h1.49c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7h-1.5v3.8c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7v1.5h3.8c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5z"></path></svg></span>Third-party integrations</a></p><h1 class="PostHeader__title">Inject Google Analytics tag manager in a Meteor app</h1><p class="PostHeader__meta">Tuesday March 6th, 2018</p></div><div class="TextBlock"><p>Sometimes we want to inject data with the original HTML request to make it available sooner, in cases like Google Analytics tag manager it needs to be inserted two tags, one right after <code>&lt;head></code> opening and other right after <code>&lt;body></code> opening.</p><p>There's a Meteor package that makes this task easy: <a href="https://github.com/meteorhacks/meteor-inject-initial/">https://github.com/meteorhacks/meteor-inject-initial/</a></p><p>To use you need to first install it in your app:</p><pre><code>meteor add meteorhacks:inject-initial
</code></pre><p>After installed, include in your app's <code>package.json</code>:</p><pre><code>api.use('meteorhacks:inject-initial', ['client', 'server']);
</code></pre><p>On the <code>server.js</code> file use methods <code>Inject.rawHead</code> and <code>Inject.rawBody</code>:</p><pre><code>Inject.rawHead('headGA', `
&lt;!-- Google Tag Manager -->
&lt;script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'<a class="vglnk" href="https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f)" rel="nofollow"><span>https</span><span>://</span><span>www</span><span>.</span><span>googletagmanager</span><span>.</span><span>com</span><span>/</span><span>gtm</span><span>.</span><span>js</span><span>?</span><span>id</span><span>='+</span><span>i</span><span>+</span><span>dl</span><span>;</span><span>f</span><span>.</span><span>parentNode</span><span>.</span><span>insertBefore</span><span>(</span><span>j</span><span>,</span><span>f</span><span>)</span></a>;
})(window,document,'script','dataLayer','YOUR_TAG_ID');&lt;/script>
&lt;!-- End Google Tag Manager -->
`);
</code></pre><pre><code>Inject.rawBody('bodyGA', `
&lt;!-- Google Tag Manager (noscript) -->
&lt;noscript>&lt;iframe src="<a class="vglnk" href="https://www.googletagmanager.com/ns.html?id=YOUR_TAG_ID" rel="nofollow"><span>https</span><span>://</span><span>www</span><span>.</span><span>googletagmanager</span><span>.</span><span>com</span><span>/</span><span>ns</span><span>.</span><span>html</span><span>?</span><span>id</span><span>=</span><span>YOUR</span><span>_</span><span>TAG</span><span>_</span><span>ID</span></a>"
height="0" width="0" style="display:none;visibility:hidden">&lt;/iframe>&lt;/noscript>
&lt;!-- End Google Tag Manager (noscript) -->
`);
</code></pre><p>That's it, it's done!</p><figure><img alt="Example of a Meteor app source code with GA tag manager injected" src="/content/posts/2018-03-06-inject-google-analytics-tag-manager-in-a-meteor-app/source-code.png"><figcaption>Example of a Meteor app source code with GA tag manager injected</figcaption></figure></div></div><div class="Disqus"><div id="disqus_thread"><iframe id="dsq-app4645" name="dsq-app4645" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&f=bernardodiasc&t_i=2018-03-06-inject-google-analytics-tag-manager-in-a-meteor-app&t_u=http%3A%2F%2Flocalhost%3A45678%2F2018%2F03%2F06%2Finject-google-analytics-tag-manager-in-a-meteor-app&t_e=Inject%20Google%20Analytics%20tag%20manager%20in%20a%20Meteor%20app&t_d=Inject%20Google%20Analytics%20tag%20manager%20in%20a%20Meteor%20app&t_t=Inject%20Google%20Analytics%20tag%20manager%20in%20a%20Meteor%20app&s_o=default#version=3e91f895da97667a42583677a655c093" style="width:1px!important;min-width:100%!important;border:none!important;overflow:hidden!important;height:467px!important" horizontalscrolling="no" verticalscrolling="no"></iframe></div></div></div></article></main></div><script src="https://www.googletagmanager.com/gtag/js?id=UA-10219275-4" async></script><script>if("localhost"!==window.location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-10219275-4")}</script><script src="/static/js/main.9a1f0496.js" type="text/javascript"></script><script src="https://bernardodiasc.disqus.com/embed.js" async id="dsq-embed-scr"></script><iframe style="display:none"></iframe></body></html>