<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"><meta content="#000000" name="theme-color"><link href="/manifest.json" rel="manifest"><link href="/favicon.ico" rel="shortcut icon"><title>Inject Google Analytics tag manager in a Meteor app - Bernardo Dias da Cruz</title><link href="/styles/main.css" rel="stylesheet"><link href="/static/css/main.e9ef1639.css" rel="stylesheet"><link href="https://www.googletagmanager.com" rel="preconnect"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="/" rel="canonical" data-react-helmet="true"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app" data-react-helmet="true" name="description"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app" data-react-helmet="true" name="twitter:card"><meta content="@bernardodiasc" data-react-helmet="true" name="twitter:site"><meta content="Inject Google Analytics tag manager in a Meteor app - Bernardo Dias da Cruz" data-react-helmet="true" name="twitter:title"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app" data-react-helmet="true" name="twitter:description"><meta content="@bernardodiasc" data-react-helmet="true" name="twitter:creator"><meta content="Inject Google Analytics tag manager in a Meteor app - Bernardo Dias da Cruz" data-react-helmet="true" property="og:title"><meta content="article" data-react-helmet="true" property="og:type"><meta content="https://bernardodiasc.github.io/" data-react-helmet="true" property="og:url"><meta content="Instructions about how to easily inject GA tag manager in a Meteor app" data-react-helmet="true" property="og:description"><meta content="Bernardo Dias da Cruz" data-react-helmet="true" property="og:site_name"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect"><link href="https://bernardodiasc.disqus.com" rel="preconnect"><link href="https://c.disquscdn.com/next/embed/styles/lounge.2d848eddee1b8c12749b72a04b2b33dc.css" rel="preload" as="style"><link href="https://c.disquscdn.com/next/embed/common.bundle.774abcf1e2c32f6ee53499b090f48ff0.js" rel="preload" as="script"><link href="https://c.disquscdn.com/next/embed/lounge.bundle.8241ae5fc761eb94635acdc63f5fd29f.js" rel="preload" as="script"><link href="https://disqus.com/next/config.js" rel="preload" as="script"><link href="https://disqus.com" rel="preconnect"><link href="https://c.disquscdn.com" rel="preconnect"><script src="https://c.disquscdn.com/next/embed/alfalfa.4a5fcca1fe50a757044dfd331b660625.js" async charset="UTF-8"></script><link href="https://ssl.google-analytics.com" rel="preconnect"><link href="https://apis.google.com" rel="preconnect"><link href="http://cdn.viglink.com" rel="preconnect"><link href="https://connect.facebook.net" rel="preconnect"><link href="https://staticxx.facebook.com" rel="preconnect"><link href="https://accounts.google.com" rel="preconnect"><link href="https://ssl.gstatic.com" rel="preconnect"><link href="https://links.services.disqus.com" rel="preconnect"><link href="http://links.services.disqus.com" rel="preconnect"><link href="https://www.facebook.com" rel="preconnect"><link href="https://glitter.services.disqus.com" rel="preconnect"><link href="https://referrer.disqus.com" rel="preconnect"><link href="https://pippio.com" rel="preconnect"><link href="https://tags.bluekai.com" rel="preconnect"><link href="https://bcp.crwdcntrl.net" rel="preconnect"><link href="https://io.narrative.io" rel="preconnect"><link href="https://stags.bluekai.com" rel="preconnect"><link href="https://loadus.exelator.com" rel="preconnect"><link href="https://magnetic.t.domdex.com" rel="preconnect"><link href="https://live.rezync.com" rel="preconnect"><link href="https://api.viglink.com" rel="preconnect"><link href="https://in.v12group.com" rel="preconnect"><link href="/static/js/main.1ca2fd4e.js" rel="preload" as="script"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><main class="Layout"><div class="Layout__headerbar"><header class="Layout-HeaderBar"><h1 class="Layout-HeaderBar__title"><a href="/" class="AppLink undefined">Random Thoughts</a></h1><div class="Layout-HeaderBar__about"><img alt="Bernardo Dias da Cruz" class="Layout-HeaderBar__about-picture" src="/images/me.jpg"><p>I'm <strong>Bernardo Dias da Cruz</strong>,<br>a senior web developer.</p><p><a href="/about-me" class="AppLink undefined">Click here to know more about me.</a></p><p class="Layout-HeaderBar__social"><span>Follow me on </span><a href="https://github.com/bernardodiasc" rel="noopener noreferrer" target="_blank">GitHub</a><span> and </span><a href="https://twitter.com/bernardodiasc" rel="noopener noreferrer" target="_blank">Twitter</a></p></div><nav class="Layout-HeaderBar__further"><h2>Looking further?</h2><ul class="Layout-HeaderBar__further-list"><li class="Layout-HeaderBar__further-item"><a href="/archive" class="AppLink undefined">Archive</a></li><li class="Layout-HeaderBar__further-item"><a href="/search" class="AppLink undefined">Search for content</a></li></ul></nav></header></div><article class="Layout__content"><div class="PostDetails"><h1 class="PostDetails__title">Inject Google Analytics tag manager in a Meteor app</h1><p class="PostDetails__meta">Tuesday March 6th, 2018</p><div class="TextBlock"><p>Sometimes we want to inject data with the original HTML request to make it available sooner, in cases like Google Analytics tag manager it needs to be inserted two tags, one right after <code>&lt;head></code> opening and other right after <code>&lt;body></code> opening.</p><p>There's a Meteor package that makes this task easy: <a href="https://github.com/meteorhacks/meteor-inject-initial/">https://github.com/meteorhacks/meteor-inject-initial/</a></p><p>To use you need to first install it in your app:</p><pre><code>meteor add meteorhacks:inject-initial
</code></pre><p>After installed, include in your app's <code>package.json</code>:</p><pre><code>api.use('meteorhacks:inject-initial', ['client', 'server']);
</code></pre><p>On the <code>server.js</code> file use methods <code>Inject.rawHead</code> and <code>Inject.rawBody</code>:</p><pre><code>Inject.rawHead('headGA', `
&lt;!-- Google Tag Manager -->
&lt;script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'<a href="https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f)" class="vglnk" rel="nofollow"><span>https</span><span>://</span><span>www</span><span>.</span><span>googletagmanager</span><span>.</span><span>com</span><span>/</span><span>gtm</span><span>.</span><span>js</span><span>?</span><span>id</span><span>='+</span><span>i</span><span>+</span><span>dl</span><span>;</span><span>f</span><span>.</span><span>parentNode</span><span>.</span><span>insertBefore</span><span>(</span><span>j</span><span>,</span><span>f</span><span>)</span></a>;
})(window,document,'script','dataLayer','YOUR_TAG_ID');&lt;/script>
&lt;!-- End Google Tag Manager -->
`);
</code></pre><pre><code>Inject.rawBody('bodyGA', `
&lt;!-- Google Tag Manager (noscript) -->
&lt;noscript>&lt;iframe src="<a href="https://www.googletagmanager.com/ns.html?id=YOUR_TAG_ID" class="vglnk" rel="nofollow"><span>https</span><span>://</span><span>www</span><span>.</span><span>googletagmanager</span><span>.</span><span>com</span><span>/</span><span>ns</span><span>.</span><span>html</span><span>?</span><span>id</span><span>=</span><span>YOUR</span><span>_</span><span>TAG</span><span>_</span><span>ID</span></a>"
height="0" width="0" style="display:none;visibility:hidden">&lt;/iframe>&lt;/noscript>
&lt;!-- End Google Tag Manager (noscript) -->
`);
</code></pre><p>That's it, it's done!</p><figure><img alt="Example of a Meteor app source code with GA tag manager injected" width="100%" src="/content/posts/2018-03-06-inject-google-analytics-tag-manager-in-a-meteor-app/source-code.png"><figcaption>Example of a Meteor app source code with GA tag manager injected</figcaption></figure></div></div><div class="Disqus"><div id="disqus_thread"><iframe id="dsq-app4211" name="dsq-app4211" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&f=bernardodiasc&t_i=2018-03-06-inject-google-analytics-tag-manager-in-a-meteor-app&t_u=http%3A%2F%2Flocalhost%3A45678%2F2018%2F03%2F06%2Finject-google-analytics-tag-manager-in-a-meteor-app&t_e=Inject%20Google%20Analytics%20tag%20manager%20in%20a%20Meteor%20app&t_d=Inject%20Google%20Analytics%20tag%20manager%20in%20a%20Meteor%20app&t_t=Inject%20Google%20Analytics%20tag%20manager%20in%20a%20Meteor%20app&s_o=default#version=764be64b45588e3d4124c2234e67fa3c" style="width:1px!important;min-width:100%!important;border:none!important;overflow:hidden!important;height:467px!important" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width:410px!important;border:none!important;overflow:hidden!important;top:0!important;min-width:410px!important;max-width:410px!important;position:fixed!important;z-index:2147483646!important;height:18px!important;min-height:18px!important;max-height:18px!important;display:none!important"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width:410px!important;border:none!important;overflow:hidden!important;bottom:0!important;min-width:410px!important;max-width:410px!important;position:fixed!important;z-index:2147483646!important;height:18px!important;min-height:18px!important;max-height:18px!important;display:none!important"></iframe></div></div></article></main></div><script src="https://www.googletagmanager.com/gtag/js?id=UA-10219275-4" async></script><script>if("localhost"!==window.location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-10219275-4")}</script><script src="/static/js/main.1ca2fd4e.js" type="text/javascript"></script><script src="https://bernardodiasc.disqus.com/embed.js" async id="dsq-embed-scr"></script><iframe style="display:none"></iframe></body></html>