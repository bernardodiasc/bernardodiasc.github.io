<!DOCTYPE html><html lang="pt" data-astro-cid-sckkx6r4> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Astro v5.17.3"><title>Componente renderizador de Markdown que pode renderizar outros componentes React - Bernardo Dias da Cruz</title><meta name="description" content="Os conteúdos em Markdown ficaram muito muito melhores!"><link rel="canonical" href="https://bernardodiasdacruz.com/pt/2018/04/09/markdown-renderer-component-that-can-render-other-react-components/"><meta name="twitter:site" content="@bernardodiasc"><meta name="twitter:title" content="Componente renderizador de Markdown que pode renderizar outros componentes React"><meta name="twitter:description" content="Os conteúdos em Markdown ficaram muito muito melhores!"><meta name="twitter:creator" content="@bernardodiasc"><meta name="twitter:image" content="https://bernardodiasdacruz.com/images/thumbnail.png"><meta property="og:title" content="Componente renderizador de Markdown que pode renderizar outros componentes React"><meta property="og:type" content="article"><meta property="og:url" content="https://bernardodiasdacruz.com/pt/2018/04/09/markdown-renderer-component-that-can-render-other-react-components/"><meta property="og:image" content="https://bernardodiasdacruz.com/images/thumbnail.png"><meta property="og:description" content="Os conteúdos em Markdown ficaram muito muito melhores!"><meta property="og:site_name" content="Bernardo Dias da Cruz"><link rel="shortcut icon" href="/favicon.ico"><meta name="google-site-verification" content="w8owtTJwheQ0pp3DJ-bwIKX67nyi2bdCZs8fLs-r-Wc"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=IBM+Plex+Serif:wght@400&family=Permanent+Marker&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_astro/_title_.CGcNIkLq.css">
<style>.share[data-astro-cid-ung7bpju]{font-size:var(--meta-size);display:flex;gap:.75em;margin-bottom:1em}.share__button[data-astro-cid-ung7bpju]{opacity:.5;transition:opacity .4s ease-out;color:var(--heading-color);font-size:.85em}.share__button[data-astro-cid-ung7bpju]:hover{opacity:1;text-decoration:underline}.post-details[data-astro-cid-bangc7to]{font-size:var(--text-size);padding:2em 2em 4em}.disqus[data-astro-cid-r2x3s5wt]{font-size:var(--text-size);padding:2em}
.icon[data-astro-cid-patnjmll]{fill:currentColor;width:100%;height:100%;display:block}
.text-block{font-size:var(--text-size);width:100%;overflow:inherit}.text-block h1,.text-block h2,.text-block h3,.text-block h4,.text-block h5,.text-block h6{font-family:var(--heading-family);color:var(--heading-color);font-weight:var(--heading-weight);line-height:var(--heading-line)}.text-block h1{font-size:var(--heading-level1-size);margin:var(--heading-level1-margins)}.text-block h2{font-size:var(--heading-level2-size);margin:var(--heading-level2-margins);padding-bottom:.3em;border-bottom:1px solid var(--line-light)}.text-block h3{font-size:var(--heading-level3-size);margin:var(--heading-level3-margins);text-transform:uppercase}.text-block h4{font-size:var(--heading-level4-size);margin:var(--heading-level4-margins);font-weight:var(--heading-weight-bold)}.text-block h5{font-size:var(--heading-level5-size);margin:var(--heading-level5-margins)}.text-block h6{font-size:var(--heading-level6-size);margin:var(--heading-level6-margins)}.text-block p{font-family:var(--text-family);color:var(--text-color);font-size:var(--text-size);font-weight:var(--text-weight);line-height:var(--text-line);word-wrap:break-word;margin:0 0 1em;text-align:justify;hyphens:auto}.text-block a{color:inherit;background-image:linear-gradient(to bottom,transparent 37%,var(--link-background) 37%);background-size:100% 300%;background-position:0 10%;transition-property:background-position;transition-duration:.4s;outline:none}.text-block a:hover{background-position:0 100%}.text-block blockquote{border-left:10px solid var(--code-background);margin:30px 0;padding:0 0 0 25px}.text-block pre{background:var(--pre-background);color:var(--pre-color);padding:1.3em 2em;margin:.5em -2em 1.2em;line-height:1;overflow-x:auto}.text-block code{background:var(--code-background);padding:.1em .3em .2em;color:var(--code-color);border-radius:2px;font-size:.9em}.text-block pre code{background:unset;color:inherit;padding:0;font-size:.8em;white-space:pre}.text-block ul,.text-block ol{font-family:var(--text-family);color:var(--text-color);font-size:var(--text-size);font-weight:var(--text-weight);line-height:var(--text-line);margin:.5em 0 1.2em 1em;padding:0 0 0 1em}.text-block ul{list-style:initial}.text-block ol{list-style:decimal}.text-block ul ul,.text-block ol ol{margin-bottom:.5em}.text-block li{margin:0}.text-block ul ul li{list-style:circle}.text-block ul ul ul li{list-style:square}.text-block hr{margin:3rem 0;height:1px;border:none;border-bottom:1px solid var(--line-heavy)}.text-block table{display:block;width:100%;overflow:auto}.text-block table tr{background-color:#fff;border-top:1px solid var(--line-heavy)}.text-block table tr:nth-child(2n){background-color:#f8f8f8}.text-block table th{font-weight:600}.text-block table th,.text-block table td{padding:.5em 1em;border:1px solid var(--line-light)}.text-block table td{font-weight:var(--text-weight)}.text-block img{max-width:100%}.text-block figure{margin:1.5em 0;text-align:center}.text-block figcaption{font-size:var(--meta-size);color:var(--meta-color);font-style:italic;text-align:center}.text-block iframe{margin:2em auto;display:block}.text-block>:first-child{margin-top:0}.text-block>:last-child{margin-bottom:0}
.post-header[data-astro-cid-yl355ysp]{font-size:var(--text-size)}.post-header__title[data-astro-cid-yl355ysp]{color:var(--heading-color);font-size:var(--heading-level1-size);margin:0 0 .3em}.post-header--listing[data-astro-cid-yl355ysp] .post-header__title[data-astro-cid-yl355ysp]{font-size:var(--heading-level2-size)}.post-header--listing[data-astro-cid-yl355ysp]:hover .post-header__title[data-astro-cid-yl355ysp]{text-decoration:underline}.post-header__icon[data-astro-cid-yl355ysp]{flex-shrink:0;display:inline-block;height:.8em;width:.8em;margin:0 4px 0 0;transform:translateY(3px)}.post-header--details[data-astro-cid-yl355ysp] .post-header__icon[data-astro-cid-yl355ysp]{height:1em;width:1em;margin:0 5px 0 0}.post-header__meta[data-astro-cid-yl355ysp]{color:var(--meta-color);font-size:var(--meta-size);margin:0 0 1em}.post-header__category[data-astro-cid-yl355ysp]{margin:0 0 .5em}.post-header__category-link[data-astro-cid-yl355ysp]{color:var(--heading-color)}.post-header__category-link[data-astro-cid-yl355ysp]:hover{color:var(--text-color);text-decoration:underline}.post-header__excerpt[data-astro-cid-yl355ysp]{color:var(--text-color)}
</style></head> <body data-astro-cid-sckkx6r4> <main class="layout" data-astro-cid-sckkx6r4> <header class="layout__header" data-astro-cid-sckkx6r4> <h1 class="layout__header-title" data-astro-cid-sckkx6r4> <a href="/pt/" data-astro-cid-sckkx6r4>Random Thoughts</a> </h1> <nav class="layout__nav" data-astro-cid-sckkx6r4> <ul class="tabs" data-astro-cid-xlvzfuxv> <li class="tabs__tab" data-astro-cid-xlvzfuxv> <a href="/pt/" title="Últimos posts" class="tabs__link" data-astro-cid-xlvzfuxv> <svg class="icon" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" data-astro-cid-patnjmll><path d="M10 20v-6h4v6h5v-8h3l-10-9-10 9h3v8z" data-astro-cid-patnjmll></path></svg> </a> </li> <li class="tabs__tab" data-astro-cid-xlvzfuxv> <a href="/pt/search" title="Buscar conteúdo" class="tabs__link" data-astro-cid-xlvzfuxv> <svg class="icon" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" data-astro-cid-patnjmll><path d="M12 10.9c-.61 0-1.1.49-1.1 1.1s.49 1.1 1.1 1.1c.61 0 1.1-.49 1.1-1.1s-.49-1.1-1.1-1.1zm0-8.9c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm2.19 12.19l-8.19 3.81 3.81-8.19 8.19-3.81-3.81 8.19z" data-astro-cid-patnjmll></path></svg> </a> </li> <li class="tabs__tab" data-astro-cid-xlvzfuxv> <a href="/pt/archive" title="Arquivo de conteúdo" class="tabs__link" data-astro-cid-xlvzfuxv> <svg class="icon" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" data-astro-cid-patnjmll><path d="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z" data-astro-cid-patnjmll></path></svg> </a> </li> <li class="tabs__tab" data-astro-cid-xlvzfuxv> <a href="/pt/about-me" title="Sobre mim" class="tabs__link" data-astro-cid-xlvzfuxv> <svg class="icon" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" data-astro-cid-patnjmll><path d="M21,13A9,9 0 0,1 12,22A9,9 0 0,1 3,13L3.03,4.43C5.68,2.88 8.76,2 12.05,2C15.3,2 18.36,2.87 21,4.38V13M13,19.93C16.39,19.44 19,16.5 19,13V5.59C16.9,4.57 14.54,4 12.05,4C9.5,4 7.08,4.6 4.94,5.66L5,13C5,16.5 7.63,19.44 11,19.93V18H13V19.93M11,16H8L6,13L9,14H10L11,13H13L14,14H15L18,13L16,16H13L12,15L11,16M6,9.03C6.64,8.4 7.5,8.05 8.5,8.05C9.45,8.05 10.34,8.4 11,9.03C10.34,9.65 9.45,10 8.5,10C7.5,10 6.64,9.65 6,9.03M13,9.03C13.64,8.4 14.5,8.05 15.5,8.05C16.45,8.05 17.34,8.4 18,9.03C17.34,9.65 16.45,10 15.5,10C14.5,10 13.64,9.65 13,9.03Z" data-astro-cid-patnjmll></path></svg> </a> </li> </ul>  <a href="/2018/04/09/markdown-renderer-component-that-can-render-other-react-components/" class="lang-switch" title="English" data-astro-cid-64r42zdf> <span class="lang-switch__current" data-astro-cid-64r42zdf>PT</span> <span class="lang-switch__separator" data-astro-cid-64r42zdf>/</span> <span class="lang-switch__other" data-astro-cid-64r42zdf>EN</span> </a>  </nav> </header> <article class="layout__content" data-astro-cid-sckkx6r4> <div class="layout__content-inner" data-astro-cid-sckkx6r4>  <div class="post-details" data-astro-cid-bangc7to> <div class="post-header post-header--details" data-astro-cid-yl355ysp><p class="post-header__category" data-astro-cid-yl355ysp><a href="/category/this-blog" class="post-header__category-link" data-astro-cid-yl355ysp><span class="post-header__icon" data-astro-cid-yl355ysp><svg class="icon" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" data-astro-cid-patnjmll><path d="M22,9V7H20V5A2,2 0 0,0 18,3H4A2,2 0 0,0 2,5V19A2,2 0 0,0 4,21H18A2,2 0 0,0 20,19V17H22V15H20V13H22V11H20V9H22M18,19H4V5H18V19M6,13H11V17H6V13M12,7H16V10H12V7M6,7H11V12H6V7M12,11H16V17H12V11Z" data-astro-cid-patnjmll></path></svg></span>This blog development process</a></p><h1 class="post-header__title" data-astro-cid-yl355ysp>Componente renderizador de Markdown que pode renderizar outros componentes React</h1><p class="post-header__meta" data-astro-cid-yl355ysp>Sunday, April 8, 2018</p></div> <div class="share" data-astro-cid-ung7bpju><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbernardodiasdacruz.com%2Fpt%2F2018%2F04%2F09%2Fmarkdown-renderer-component-that-can-render-other-react-components%2F" target="_blank" rel="noopener noreferrer" class="share__button" title="Share on Facebook" data-astro-cid-ung7bpju>Facebook</a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbernardodiasdacruz.com%2Fpt%2F2018%2F04%2F09%2Fmarkdown-renderer-component-that-can-render-other-react-components%2F&title=Componente%20renderizador%20de%20Markdown%20que%20pode%20renderizar%20outros%20componentes%20React" target="_blank" rel="noopener noreferrer" class="share__button" title="Share on LinkedIn" data-astro-cid-ung7bpju>LinkedIn</a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fbernardodiasdacruz.com%2Fpt%2F2018%2F04%2F09%2Fmarkdown-renderer-component-that-can-render-other-react-components%2F&text=Componente%20renderizador%20de%20Markdown%20que%20pode%20renderizar%20outros%20componentes%20React" target="_blank" rel="noopener noreferrer" class="share__button" title="Share on Twitter" data-astro-cid-ung7bpju>Twitter</a><a href="https://www.reddit.com/submit?url=https%3A%2F%2Fbernardodiasdacruz.com%2Fpt%2F2018%2F04%2F09%2Fmarkdown-renderer-component-that-can-render-other-react-components%2F&title=Componente%20renderizador%20de%20Markdown%20que%20pode%20renderizar%20outros%20componentes%20React" target="_blank" rel="noopener noreferrer" class="share__button" title="Share on Reddit" data-astro-cid-ung7bpju>Reddit</a></div> <div class="text-block">   <p>Certo, anteriormente eu escrevi sobre como este site renderiza conteúdo de arquivos Markdown, você pode ler aqui: <a href="https://bernardodiasdacruz.com/2018/03/17/creating-react-component-with-markdown-renderer-and-code-syntax-highlight">Criando componente React com renderizador de Markdown e syntax highlight de código</a>. Neste post vou explicar algumas melhorias legais que fiz no componente <code>MarkdownRenderer</code> usado neste site.</p>
<h2 id="como-estava-funcionando-até-então">Como estava funcionando até então</h2>
<p>Só para dar um pouco de contexto, este site usa arquivos markdown estáticos para armazenar o conteúdo. Não existe uma interface de editor rich-text para fornecer recursos sofisticados para diferentes tipos de representação de dados. Se eu quisesse incluir uma imagem no meio do post, tinha que declarar explicitamente a marcação usando tags HTML:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">figure</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">  &#x3C;</span><span style="color:#E06C75">img</span><span style="color:#D19A66"> alt</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"The alternative textual representation"</span><span style="color:#D19A66"> src</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"full-path/of/the-image.png"</span><span style="color:#ABB2BF"> /></span></span>
<span class="line"><span style="color:#ABB2BF">  &#x3C;</span><span style="color:#E06C75">figcaption</span><span style="color:#ABB2BF">>Some helpful caption&#x3C;/</span><span style="color:#E06C75">figcaption</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;/</span><span style="color:#E06C75">figure</span><span style="color:#ABB2BF">></span></span></code></pre>
<p>Não é difícil, porém muito repetitivo e propenso a falhas. Na verdade é um pouco chato fazer isso repetidamente toda vez. O markdown em si fornece muitos padrões para simplificar as estruturas de dados, e é incrível. Mas o markdown é limitado e é por isso que para muitos conteúdos não textuais, estruturas de dados mais complexas são necessárias.</p>
<h2 id="o-que-se-espera">O que se espera</h2>
<p>Sabe o que seria legal? Componentes React dentro do conteúdo markdown!</p>
<p>Usando um componente React eu posso simplificar os padrões de estrutura de dados e também incluir comportamentos incríveis com funcionalidades completas. Sabe como é, React! Vamos ver alguns exemplos:</p>
<h3 id="imagens">Imagens</h3>
<p>Como mencionado antes, era assim que eu incluía imagens no markdown:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">figure</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">  &#x3C;</span><span style="color:#E06C75">img</span><span style="color:#D19A66"> alt</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"The alternative textual representation"</span><span style="color:#D19A66"> src</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"path/of/the/image.png"</span><span style="color:#ABB2BF"> /></span></span>
<span class="line"><span style="color:#ABB2BF">  &#x3C;</span><span style="color:#E06C75">figcaption</span><span style="color:#ABB2BF">>Some helpful caption&#x3C;/</span><span style="color:#E06C75">figcaption</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;/</span><span style="color:#E06C75">figure</span><span style="color:#ABB2BF">></span></span></code></pre>
<p>E é assim com o componente React <code>Image</code>:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">Image</span></span>
<span class="line"><span style="color:#D19A66">  alt</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"The alternative textual representation"</span></span>
<span class="line"><span style="color:#D19A66">  src</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"path/of/the/image.png"</span></span>
<span class="line"><span style="color:#D19A66">  caption</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"Some helpful caption"</span></span>
<span class="line"><span style="color:#ABB2BF">/></span></span></code></pre>
<p>Mais simples, né? Pode não parecer absurdamente mais simples à primeira vista, mas se olharmos mais a fundo no componente <code>Image</code>, veremos um monte de recursos legais e um mundo de possibilidades.</p>
<h3 id="embed-codepen">Embed Codepen</h3>
<p>A API dos componentes React é feita da forma que eu desejar. Não preciso seguir nenhuma especificação HTML5 ou padrões da comunidade. Vamos ver um exemplo mais complexo:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#7F848E;font-style:italic">&#x3C;!-- Using Iframe --></span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">iframe</span></span>
<span class="line"><span style="color:#D19A66">  height</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"600"</span></span>
<span class="line"><span style="color:#D19A66">  scrolling</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"no"</span></span>
<span class="line"><span style="color:#D19A66">  title</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"Card pack"</span></span>
<span class="line"><span style="color:#D19A66">  src</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"//codepen.io/bernardodiasc/embed/rdZmjK/?height=600&#x26;theme-id=0&#x26;default-tab=result&#x26;embed-version=2"</span></span>
<span class="line"><span style="color:#D19A66">  frameborder</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"no"</span></span>
<span class="line"><span style="color:#D19A66">  allowtransparency</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"true"</span></span>
<span class="line"><span style="color:#D19A66">  allowfullscreen</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"true"</span></span>
<span class="line"><span style="color:#D19A66">  style</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"width: 100%;"</span></span>
<span class="line"><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">  See the Pen &#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> href</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://codepen.io/bernardodiasc/pen/rdZmjK/"</span><span style="color:#ABB2BF">>Card pack&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">> by Bernardo Dias (&#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> href</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://codepen.io/bernardodiasc"</span><span style="color:#ABB2BF">>@bernardodiasc&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">>) on &#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> href</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://codepen.io"</span><span style="color:#ABB2BF">>CodePen&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">>.</span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;/</span><span style="color:#E06C75">iframe</span><span style="color:#ABB2BF">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">&#x3C;!-- Or the recommended way --></span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">p</span></span>
<span class="line"><span style="color:#D19A66">  data-height</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"600"</span></span>
<span class="line"><span style="color:#D19A66">  data-theme-id</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"0"</span></span>
<span class="line"><span style="color:#D19A66">  data-slug-hash</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"rdZmjK"</span></span>
<span class="line"><span style="color:#D19A66">  data-default-tab</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"result"</span></span>
<span class="line"><span style="color:#D19A66">  data-user</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"bernardodiasc"</span></span>
<span class="line"><span style="color:#D19A66">  data-embed-version</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"2"</span></span>
<span class="line"><span style="color:#D19A66">  data-pen-title</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"Card pack"</span></span>
<span class="line"><span style="color:#D19A66">  class</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"codepen"</span></span>
<span class="line"><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">  See the Pen &#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> href</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://codepen.io/bernardodiasc/pen/rdZmjK/"</span><span style="color:#ABB2BF">>Card pack&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">> by Bernardo Dias (&#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> href</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://codepen.io/bernardodiasc"</span><span style="color:#ABB2BF">>@bernardodiasc&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">>) on &#x3C;</span><span style="color:#E06C75">a</span><span style="color:#D19A66"> href</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://codepen.io"</span><span style="color:#ABB2BF">>CodePen&#x3C;/</span><span style="color:#E06C75">a</span><span style="color:#ABB2BF">>.</span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;/</span><span style="color:#E06C75">p</span><span style="color:#ABB2BF">></span></span>
<span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">script</span><span style="color:#D19A66"> async</span><span style="color:#D19A66"> src</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://static.codepen.io/assets/embed/ei.js"</span><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">script</span><span style="color:#ABB2BF">></span></span></code></pre>
<p>Tudo isso pode ser simplificado e padronizado:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">Codepen</span></span>
<span class="line"><span style="color:#D19A66">  hash</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"rdZmjK"</span></span>
<span class="line"><span style="color:#D19A66">  height</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"600"</span></span>
<span class="line"><span style="color:#D19A66">  title</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"Card pack"</span></span>
<span class="line"><span style="color:#ABB2BF">/></span></span></code></pre>
<p>Muito melhor! Deixe o componente React cuidar dos padrões gerais. Deixe o conteúdo markdown mais simples.</p>
<h3 id="embed-de-vídeo">Embed de vídeo</h3>
<p>Só mais um último exemplo :)</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">iframe</span></span>
<span class="line"><span style="color:#D19A66">  width</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"560"</span></span>
<span class="line"><span style="color:#D19A66">  height</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"315"</span></span>
<span class="line"><span style="color:#D19A66">  src</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"https://www.youtube.com/embed/dnzE9ip5U04?rel=0"</span></span>
<span class="line"><span style="color:#D19A66">  frameborder</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"0"</span></span>
<span class="line"><span style="color:#D19A66">  allow</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"encrypted-media"</span></span>
<span class="line"><span style="color:#D19A66">  allowfullscreen</span></span>
<span class="line"><span style="color:#ABB2BF">>&#x3C;/</span><span style="color:#E06C75">iframe</span><span style="color:#ABB2BF">></span></span></code></pre>
<p>Para se tornar:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#ABB2BF">&#x3C;</span><span style="color:#E06C75">Video</span><span style="color:#D19A66"> hash</span><span style="color:#ABB2BF">=</span><span style="color:#98C379">"dnzE9ip5U04"</span><span style="color:#FFFFFF"> /</span><span style="color:#ABB2BF">></span></span></code></pre>
<p>Propriedades de dimensionamento serão praticamente as mesmas quase todas as vezes para o caso de uso deste site e então podem ser opcionais. O mesmo vale para todos os outros atributos.</p>
<h2 id="como-fazer-algo-tão-incrível">Como fazer algo tão incrível?</h2>
<p>Agora vamos à solução de fato!</p>
<p>Para fazer essa melhoria no meu componente <code>MarkdownRenderer</code> existente, fiz uma troca da lib <a href="https://github.com/markedjs/marked/">https://github.com/markedjs/marked/</a> em favor da <a href="https://github.com/probablyup/markdown-to-jsx">https://github.com/probablyup/markdown-to-jsx</a>.</p>
<p>Honestamente, não posso reclamar da implementação anterior deste componente. Estava faltando apenas um recurso para proporcionar tamanha maravilha: a capacidade de sobrescrever elementos. E esse é um dos recursos mais legais do <strong>markdown-to-jsx</strong>.</p>
<h3 id="syntax-highlight-de-blocos-de-código">Syntax highlight de blocos de código</h3>
<p>Fazer essa mudança teve uma desvantagem em relação aos blocos de código e syntax highlight. Vou explicar abaixo, mas por causa disso, reconsiderei a mudança. A princípio, considerei implementar o recurso desejado no <a href="https://github.com/utatti/react-render-html">https://github.com/utatti/react-render-html</a>, basicamente permitindo a opção de <code>overrides</code>, igual ao <strong>markdown-to-jsx</strong>. Isso exigiria muito mais tempo da minha parte, infelizmente preciso ser pragmático aqui. O que torna um pouco difícil é que o <strong>react-render-html</strong> depende do <a href="https://github.com/inikulin/parse5">https://github.com/inikulin/parse5</a>, e esse é um parser muito estrito e compatível com a especificação HTML5. De qualquer forma, isso ainda é uma possibilidade se eu encontrar tempo para uma contribuição open source e se o autor da biblioteca desejar.</p>
<p>Voltando à desvantagem, na verdade não é nada demais. O ponto é que o <strong>markdown-to-jsx</strong> é compatível com o <strong>highlight.js</strong> MAS ele só adiciona as classes de linguagem do código na tag <code>code</code>. Isso exigiria que o <strong>highlight.js</strong> processasse o conteúdo do código no lado do cliente. Eu não queria isso, porque tenho recurso de pré-renderização neste site e quero tirar proveito disso e aliviar o dispositivo do cliente de processamento extra o máximo possível (quero dizer, já está hidratando o app React…).</p>
<p>A solução foi sobrescrever as tags <code>pre</code> com um componente <code>CodeBlock</code> personalizado:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#C678DD">const</span><span style="color:#61AFEF"> CodeBlock</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75;font-style:italic">node</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=></span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> props</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> node</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">children</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">props</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> language</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> props</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">className</span><span style="color:#C678DD"> ?</span><span style="color:#E5C07B"> props</span><span style="color:#ABB2BF">.</span><span style="color:#E5C07B">className</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">replace</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">/</span><span style="color:#C678DD">^</span><span style="color:#E06C75">(lang-)/</span><span style="color:#ABB2BF">, </span><span style="color:#98C379">''</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">:</span><span style="color:#98C379"> ''</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> code</span><span style="color:#56B6C2"> =</span><span style="color:#E5C07B"> props</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">children</span><span style="color:#56B6C2"> ||</span><span style="color:#98C379"> ''</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> htmlBlock</span><span style="color:#56B6C2"> =</span><span style="color:#E06C75"> language</span></span>
<span class="line"><span style="color:#C678DD">    ?</span><span style="color:#E5C07B"> hljs</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">highlight</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">language</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">code</span><span style="color:#ABB2BF">).</span><span style="color:#E06C75">value</span></span>
<span class="line"><span style="color:#C678DD">    :</span><span style="color:#E5C07B"> hljs</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">highlightAuto</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">code</span><span style="color:#ABB2BF">).</span><span style="color:#E06C75">value</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#61AFEF"> renderHTML</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">`&#x3C;pre>&#x3C;code class="</span><span style="color:#C678DD">${</span><span style="color:#E5C07B">props</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">className</span><span style="color:#C678DD">}</span><span style="color:#98C379">"></span><span style="color:#C678DD">${</span><span style="color:#E06C75">htmlBlock</span><span style="color:#C678DD">}</span><span style="color:#98C379">&#x3C;/code>&#x3C;/pre>`</span><span style="color:#ABB2BF">)</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre>
<p>Bem, isso ainda depende do <strong>react-render-html</strong> e como observado na biblioteca, o <strong>parse5</strong> é uma biblioteca pesada. Felizmente, como eu disse, este site tem pré-renderização, vai funcionar com JS desabilitado (experimente). Então não estou muito preocupado com o peso do bundle JS já que não é um bloqueador para a experiência principal.</p>
<h3 id="o-componente-renderizador-de-markdown">O componente renderizador de markdown</h3>
<p>Certo certo, apesar dessa situação do syntax highlight dos blocos de código, todo o resto teve uma transição suave. Aqui está como o render do componente ficou agora:</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#C678DD">class</span><span style="color:#E5C07B"> MarkdownRenderer</span><span style="color:#C678DD"> extends</span><span style="color:#E5C07B"> PureComponent</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#C678DD">  static</span><span style="color:#E06C75"> defaultProps</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#E06C75">    text</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">''</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF">  render</span><span style="color:#ABB2BF">() {</span></span>
<span class="line"><span style="color:#C678DD">    const</span><span style="color:#ABB2BF"> { </span><span style="color:#E5C07B">text</span><span style="color:#ABB2BF"> } </span><span style="color:#56B6C2">=</span><span style="color:#E5C07B"> this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">props</span></span>
<span class="line"><span style="color:#C678DD">    return</span><span style="color:#E06C75"> text</span><span style="color:#C678DD"> ?</span><span style="color:#ABB2BF"> (</span></span>
<span class="line"><span style="color:#ABB2BF">      &#x3C;</span><span style="color:#E5C07B">Markdown</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic">        children</span><span style="color:#56B6C2">=</span><span style="color:#C678DD">{</span><span style="color:#E06C75">text</span><span style="color:#C678DD">}</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic">        options</span><span style="color:#56B6C2">=</span><span style="color:#C678DD">{</span><span style="color:#ABB2BF">{</span></span>
<span class="line"><span style="color:#E06C75">          overrides</span><span style="color:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75">            Icon</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">            Image</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">            Codepen</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">            Video</span><span style="color:#ABB2BF">,</span></span>
<span class="line"><span style="color:#E06C75">            pre</span><span style="color:#ABB2BF">: {</span></span>
<span class="line"><span style="color:#E06C75">              component</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">CodeBlock</span></span>
<span class="line"><span style="color:#ABB2BF">            }</span></span>
<span class="line"><span style="color:#ABB2BF">          },</span></span>
<span class="line"><span style="color:#ABB2BF">        }</span><span style="color:#C678DD">}</span></span>
<span class="line"><span style="color:#ABB2BF">      /></span></span>
<span class="line"><span style="color:#ABB2BF">    ) </span><span style="color:#C678DD">:</span><span style="color:#D19A66"> null</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre>
<p>Observe as opções de <code>overrides</code>, posso fazer muito mais com isso, é realmente legal e vale a pena conferir a documentação da biblioteca <a href="https://github.com/probablyup/markdown-to-jsx#optionsoverrides---override-any-html-tags-representation">https://github.com/probablyup/markdown-to-jsx#optionsoverrides---override-any-html-tags-representation</a>.</p>
<h2 id="conclusão">Conclusão</h2>
<p>As estruturas de dados na marcação são todas sobre representação de conteúdo. E os padrões estão lá para aliviar a carga mental de tarefas repetitivas, como escrever essas estruturas de dados de marcação. Templates para marcação sempre existiram, embora sejam mais legais e poderosos agora na era das bibliotecas de renderização JS no lado do cliente.</p>
<p>Simples é melhor!</p>   </div>  </div>  <div class="disqus" id="disqus_thread" data-astro-cid-r2x3s5wt></div> <script>(function(){const identifier = "pt-2018-04-09-markdown-renderer-component-that-can-render-other-react-components";
const title = "Componente renderizador de Markdown que pode renderizar outros componentes React";
const url = "https://bernardodiasdacruz.com/pt/2018/04/09/markdown-renderer-component-that-can-render-other-react-components/";

  if (window.location.hostname !== 'localhost') {
    window.disqus_config = function () {
      this.page.url = url;
      this.page.identifier = identifier;
      this.page.title = title;
    };
    const d = document;
    const s = d.createElement('script');
    s.src = 'https://bernardodiasc.disqus.com/embed.js';
    s.setAttribute('data-timestamp', String(+new Date()));
    (d.head || d.body).appendChild(s);
  }
})();</script>   </div> </article> </main> <script>
      if (window.location.hostname !== 'localhost') {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-10219275-4');
      }
    </script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-10219275-4"></script> </body> </html> 