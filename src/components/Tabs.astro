---
import Icon from './Icon.astro';
import { getLangFromUrl } from '../i18n/utils';
import { t } from '../i18n/translations';

const currentPath = Astro.url.pathname;
const lang = getLangFromUrl(currentPath);
const prefix = lang === 'pt' ? '/pt' : '';

function isActive(path: string) {
  if (path === prefix + '/' || path === prefix) return currentPath === prefix + '/' || currentPath === prefix;
  return currentPath.startsWith(path);
}
---

<ul class="tabs">
  <li class="tabs__tab">
    <a href={`${prefix}/`} title={t(lang, 'nav.home')} class:list={['tabs__link', { 'tabs__link--active': isActive(`${prefix}/`) }]}>
      <Icon icon="home" />
    </a>
  </li>
  <li class="tabs__tab">
    <a href={`${prefix}/search`} title={t(lang, 'nav.search')} class:list={['tabs__link', { 'tabs__link--active': isActive(`${prefix}/search`) }]}>
      <Icon icon="explore" />
    </a>
  </li>
  <li class="tabs__tab">
    <a href={`${prefix}/archive`} title={t(lang, 'nav.archive')} class:list={['tabs__link', { 'tabs__link--active': isActive(`${prefix}/archive`) }]}>
      <Icon icon="calendar" />
    </a>
  </li>
  <li class="tabs__tab">
    <a href={`${prefix}/about-me`} title={t(lang, 'nav.about')} class:list={['tabs__link', { 'tabs__link--active': isActive(`${prefix}/about-me`) }]}>
      <Icon icon="guy-fawkes-mask" />
    </a>
  </li>
</ul>

<style>
  .tabs {
    font-size: var(--text-size);
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .tabs__tab {
    display: inline-block;
    background: var(--content-background);
    margin: 0 0 0 5px;
    border-top-right-radius: 5px;
    border-top-left-radius: 5px;
  }

  .tabs__tab:first-of-type {
    margin: 0;
  }

  .tabs__link {
    display: block;
    width: 18px;
    height: 18px;
    color: var(--meta-color);
    transition: color 0.3s ease;
    padding: 0.3em 0.8em;
    box-sizing: content-box;
    box-shadow: 0 -1px 3px 0 rgba(45, 45, 45, 0.4) inset;
  }

  .tabs__link:hover {
    color: var(--text-color);
  }

  .tabs__link--active {
    color: var(--heading-color);
    box-shadow: none;
  }
</style>
